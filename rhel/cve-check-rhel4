cvechk () { for i in $*; do cecho "\n$i"; rhurl="`links -dump \"http://www.google.com/search?hl=en&q=%22Red+Hat+Enterprise+Linux+ES+%28v.+4%29%22+site%3Arhn.redhat.com%2Ferrata+%22$i%22&btnG=Search\"|egrep 'RHSA.*.html'|sed 's/^ *//'|sed 's/.html.*/.html/'`"; if [ -n "$rhurl" ]; then echo "$rhurl"; else rhstmt="`links -dump \"http://web.nvd.nist.gov/view/vuln/detail?vulnId=$i\"|grep -A10 'Vendor Statments'`"; if [ -n "$rhstmt" ]; then echo http://web.nvd.nist.gov/view/vuln/detail?vulnId=$i; echo "$rhstmt"; else cvedesc="`links -dump \"http://cve.mitre.org/cgi-bin/cvename.cgi?name=$i\"|grep -A5 Description|sed -e 's/^.................//' -e 's/    *.*$//'`"; if [ -n "$cvedesc" ]; then echo http://cve.mitre.org/cgi-bin/cvename.cgi?name=$i; echo "$cvedesc"; fi; fi; fi; done }; cvechk
