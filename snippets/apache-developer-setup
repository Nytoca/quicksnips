function apachedevelopersetup () {
clear
if [ `rpm -q psa | grep -v "package psa is not installed" | wc -l` -gt 0 ]; then
  echo "Plesk installed, exiting"
else
  echo -n "Enter blanket dir to setup developer access for: "
  read devdir
  echo -n "Enter group to set for developers: "
  read devgroup
  echo -n "Enter comma delim. list of developer's user accounts: "
  read devuserlist

  devdir=`echo -n "$devdir" | sed -e 's/ *$//g' | sed -e 's/\\ / /g' | sed -e 's/ /\\ /g'`
  devgroup=`echo -n "$devgroup" | sed -e 's/ *$//g'`


  if [ `grep $devgroup /etc/group | wc -l` -gt 0 ]; then
    echo "Developer group exists \!"
  else
    echo -n "Create this group: $devgroup? [Y/n]"
    read createdevgroup
    if [ $createdevgroup = "Y" ]; then
      groupadd $devgroup
    fi
  fi

  for user in `echo "$devuserlist" | sed -e 's/\(, \|,\)/\n/g'`; do
    id $user > /dev/null 2>&1 && export olddevgroup=`id -gn $user` && usermod -g $devgroup -a -G $olddevgroup $user || useradd -g $devgroup $user
    touch `finger $user | grep "Directory: " | awk '{print $2}'`/.profile
    echo "if [ `id -gn` = "$devgroup" ]; then" >> `finger $user | grep "Directory: " | awk '{print $2}'`/.profile
    echo "  umask 002" >> `finger $user | grep "Directory: " | awk '{print $2}'`/.profile
    echo "fi" >> `finger $user | grep "Directory: " | awk '{print $2}'`/.profile
  done

  echo -n "Do you want to change group ownership to $devgroup on $devdir? [Y/n]"
  read devchgrp
  echo -n "Do you want to set the gid bit on $devdir and subfolders? [Y/n]"
  read devsetgid
  echo -n "Do you want to make the subchildren of $devdir writeable to users of $devgroup? [Y/n]"
  read devsetmode

  if [ $devchgrp = "Y" ];then
    chgrp -R $devgroup $devdir
  fi
  if [ $devsetmode = "Y" ];then
    chmod -R g+rwx $devdir
    find $devdir -name "cgi-bin" -exec chmod g-w {} \;
  fi
  if [ $devsetgid = "Y" ];then
    chmod -R g+s $devdir
  fi
fi
echo "Don't for get to configure FTP daemon umask, set it to 002."
}

apachedevelopersetup;
