# Checks a list of CVE codes for PCI scans on a RHEL5 server.

function cvechkrhel5 () { for i in $( cat $* |sed 's/\(CVE-[0-9]\{4\}-[0-9]\{4\}\)/\n\1\n/g'|egrep "CVE-[0-9]{4}-[0-9]{4}"|sort|uniq ); do cecho "\n$i"; rhurl="`links -dump \"http://www.google.com/search?q=%22Red+Hat+Enterprise+Linux+%28v.+5+server%29%22+site%3Arhn.redhat.com%2Ferrata+%22$i%22\"|egrep 'RHSA.*.html'|sed 's/^ *//'|sed 's/.html.*/.html/'`"; if [ -n "$rhurl" ]; then echo "$rhurl"; else rhstmt="`links -dump \"http://web.nvd.nist.gov/view/vuln/detail?vulnId=$i\"|grep -A10 'Vendor Statments'`"; if [ -n "$rhstmt" ]; then echo "$rhstmt"; else cvedesc="`links -dump \"http://cve.mitre.org/cgi-bin/cvename.cgi?name=$i\"|grep -A5 Description|sed -e 's/^.................//' -e 's/    *.*$//'`"; if [ -n "$cvedesc" ]; then echo "$cvedesc"; fi; fi; fi; done }; cvechkrhel5 
